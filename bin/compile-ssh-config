#!/usr/bin/ruby

SSH_CONFIG_PATH="#{Dir.home}/.ssh/config"

template = File.read("#{SSH_CONFIG_PATH}.template")
compiled = template.gsub(/\$\S+/) do |env_key|
  ENV[env_key[1..-1]] || "$#{env_key}"
end

File.write(SSH_CONFIG_PATH, compiled)
